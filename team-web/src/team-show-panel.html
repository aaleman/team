<polymer-element name="team-show-panel" attributes="userSettings example hideFlag"
                 on-removebuttonclick="{{handleRemoveClick}}"
                 on-showbuttonclick="{{handleShowClick}}"
                 on-editbuttonclick="{{handleEditClick}}"
        >
    <template>
        <link rel="stylesheet" href="../lib/jsorolla/src/lib/components/jso-style.css">
        <link rel="stylesheet" href="../lib/jsorolla/src/lib/components/jso-panel.css">
        <link rel="stylesheet" href="../lib/jsorolla/src/lib/components/sortable-table.css">
        <style>
            :host {
                display: block;
                position: relative;
                box-sizing: border-box;
                background-color: #FFFFFF;
                width: 350px;
                margin-bottom: 10px;
            }

            .container {
                box-sizing: border-box;
                padding: 1px 5px 3px 0px;
                height: 200px;
                max-height: 200px;
            }

            .container .text {
                width: 90px;
                text-align: right;
            }

            sortable-table {
                overflow-y: auto;
            }

            sortable-table::shadow > table > tbody > * {
                font-size: 11px;
            }

            sortable-table::shadow > table > thead > * {
                font-size: 12px;
            }

        </style>
        <div class="panel panel-shadow">
            <div class="header" horizontal layout
                 on-mousedown="{{handleHeaderMouseDown}}"
                 on-mouseup="{{handleHeaderMouseUp}}">
                <div class="text">{{titlePrefix}} Panels</div>
                <div class="headeractions" horizontal end-justified layout flex>
                    <div class="text headerclose" on-click="{{handleClose}}"></div>
                </div>
            </div>
            <div class="container" vertical layout>
                <sortable-table class="bootstrap"
                                id="dataGrid"
                                loading="true"
                                args="{{args}}"
                                columns="{{columns}}"
                                data="{{data}}"
                        >

                    <template id="actionsCT">
                        <td>
                            <show-button></show-button>
                            <template if="{{!args.example}}">
                                <edit-button></edit-button>
                                <remove-button></remove-button>
                            </template>

                        </td>
                    </template>


                </sortable-table>
            </div>
        </div>

    </template>
    <script>
        Polymer({
            example: false,
            titlePrefix: "User-defined",
            userSettings: null,
            args: null,
            created: function () {
                this.displayProperty = '';
                this.downX;
                this.downY;
//                this.example = false;


            },
            ready: function () {
                if (this.example) {
                    this.titlePrefix = "Example";
                }

                this.columns = [
                    {name: "name", title: "Name"},
                    {name: "panelId", title: "Id"},
                    {name: 'actions', title: 'Actions', cellTemplate: 'actionsCT'}
                ];

                this.args = {
                    handleRemovePanel: this.handleRemovePanel,
                    example: this.example
                }

            },
            domReady: function () {
                console.log("example: " + this.example);
            },
            userSettingsChanged: function (oldValue, newValue) {

                var newData = [];

                console.log("CHANGE!!");

                if (this.example) {
                    newData = newValue.getExamplePanelsJson();
                } else {
                    newData = newValue.getUserPanelsJson();
                }

                this.data = newData;
            },
            addExampleData: function () {
                console.log("add example Data");

                this.userSettings.addPanel({
                    name: "test",
                    primaryDiseases: [],
                    secondaryDiseases: [],
                    genes: [],
                    diseases: [],
                    extraGenes: [],
                    polyphen: 0,
                    sift: 0
                });
            },
            observe: {
                'userSettings.userDefined': 'userDefinedChanged'
            },
            userDefinedChanged: function (oldValue, newValue) {

                var newData = [];
                if (this.example) {
                    newData = this.userSettings.getExamplePanelsJson();
                } else {
                    newData = this.userSettings.getUserPanelsJson();
                }

                this.data = newData;
            },
            handleRemovePanel: function (a, b, c, d, e, f, g) {
                debugger
            },
            handleRemoveClick: function (event, msg) {
                console.log(msg.templateInstance.model);
            },
            handleShowClick: function (event, msg) {
                console.log(msg.templateInstance.model);
            },
            handleEditClick: function (event, msg) {
                console.log(msg.templateInstance.model);
            },
            handleClose: function () {
                console.log("close")
                this.hideFlag = true;
            }

        })
        ;
    </script>
</polymer-element>

<polymer-element name="remove-button">
    <template>
        <style>
            font-awesome::shadow .fa:hover {
                background-color: #000000;
                color: white;
            }
        </style>
        <font-awesome icon="remove" on-click="{{handleClick}}"></font-awesome>
    </template>
    <script>
        Polymer({
            handleClick: function (event, msg) {
                this.fire('removebuttonclick', this);
            }
        })
    </script>
</polymer-element>

<polymer-element name="show-button">
    <template>
        <style>
            font-awesome::shadow .fa:hover {
                background-color: #000000;
                color: white;
            }
        </style>
        <font-awesome icon="search" on-click="{{handleClick}}"></font-awesome>
    </template>
    <script>
        Polymer({
            handleClick: function (event, msg) {
                this.fire('showbuttonclick', this);
            }
        })
    </script>
</polymer-element>
<polymer-element name="edit-button">

    <template>
        <style>
            font-awesome::shadow .fa:hover {
                background-color: #000000;
                color: white;
            }
        </style>
        <font-awesome icon="edit" on-click="{{handleClick}}"></font-awesome>
    </template>
    <script>
        Polymer({
            handleClick: function (event, msg) {
                this.fire('editbuttonclick', this);
            }
        })
    </script>
</polymer-element>